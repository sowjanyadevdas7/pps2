!function(p){function i(e,n){var t=[];n||(n=0);for(var r=n;r<e.length;r++)t.push(e[r]);return t}var e;e=function(){"use strict";function e(n){var t=this.constructor;return this.then(function(e){return t.resolve(n()).then(function(){return e})},function(e){return t.resolve(n()).then(function(){return t.reject(e)})})}var n=setTimeout;function c(e){return Boolean(e&&void 0!==e.length)}function r(){}function o(e){if(!(this instanceof o))throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],f(e,this)}function i(t,r){for(;3===t._state;)t=t._value;0!==t._state?(t._handled=!0,o._immediateFn(function(){var e=1===t._state?r.onFulfilled:r.onRejected;if(null!==e){var n;try{n=e(t._value)}catch(e){return void a(r.promise,e)}s(r.promise,n)}else(1===t._state?s:a)(r.promise,t._value)})):t._deferreds.push(r)}function s(n,e){try{if(e===n)throw new TypeError("A promise cannot be resolved with itself.");if(e&&("object"==typeof e||"function"==typeof e)){var t=e.then;if(e instanceof o)return n._state=3,n._value=e,void u(n);if("function"==typeof t)return void f((r=t,i=e,function(){r.apply(i,arguments)}),n)}n._state=1,n._value=e,u(n)}catch(e){a(n,e)}var r,i}function a(e,n){e._state=2,e._value=n,u(e)}function u(e){2===e._state&&0===e._deferreds.length&&o._immediateFn(function(){e._handled||o._unhandledRejectionFn(e._value)});for(var n=0,t=e._deferreds.length;n<t;n++)i(e,e._deferreds[n]);e._deferreds=null}function l(e,n,t){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof n?n:null,this.promise=t}function f(e,n){var t=!1;try{e(function(e){t||(t=!0,s(n,e))},function(e){t||(t=!0,a(n,e))})}catch(e){if(t)return;t=!0,a(n,e)}}o.prototype.catch=function(e){return this.then(null,e)},o.prototype.then=function(e,n){var t=new this.constructor(r);return i(this,new l(e,n,t)),t},o.prototype.finally=e,o.all=function(n){return new o(function(r,i){if(!c(n))return i(new TypeError("Promise.all accepts an array"));var o=Array.prototype.slice.call(n);if(0===o.length)return r([]);var s=o.length;function a(n,e){try{if(e&&("object"==typeof e||"function"==typeof e)){var t=e.then;if("function"==typeof t)return void t.call(e,function(e){a(n,e)},i)}o[n]=e,0==--s&&r(o)}catch(e){i(e)}}for(var e=0;e<o.length;e++)a(e,o[e])})},o.resolve=function(n){return n&&"object"==typeof n&&n.constructor===o?n:new o(function(e){e(n)})},o.reject=function(t){return new o(function(e,n){n(t)})},o.race=function(i){return new o(function(e,n){if(!c(i))return n(new TypeError("Promise.race accepts an array"));for(var t=0,r=i.length;t<r;t++)o.resolve(i[t]).then(e,n)})},o._immediateFn="function"==typeof setImmediate&&function(e){setImmediate(e)}||function(e){n(e,0)},o._unhandledRejectionFn=function(e){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",e)};var t=function(){if("undefined"!=typeof self)return self;if(void 0!==p)return p;if("undefined"!=typeof global)return global;throw new Error("unable to locate global object")}();"Promise"in t?t.Promise.prototype.finally||(t.Promise.prototype.finally=e):t.Promise=o},"object"==typeof exports&&"undefined"!=typeof module||"function"==typeof define&&define.amd,e(),p.console&&p.console.log||(p.console={log:function(){}});try{Function.prototype.bind||(Function.prototype.bind=function(){var n=this,t=arguments[0],r=i(arguments,1);if("function"!=typeof n)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");return function(){var e=r.concat(i(arguments));return n.apply(t,e)}}),function(){if("function"==typeof p.CustomEvent)return;function e(e,n){n=n||{bubbles:!1,cancelable:!1,detail:void 0};var t=document.createEvent("CustomEvent");return t.initCustomEvent(e,n.bubbles,n.cancelable,n.detail),t}e.prototype=p.Event.prototype,p.CustomEvent=e}(),Object.assign||Object.defineProperty(Object,"assign",{enumerable:!1,configurable:!0,writable:!0,value:function(e){"use strict";if(null==e)throw new TypeError("Cannot convert first argument to object");for(var n=Object(e),t=1;t<arguments.length;t++){var r=arguments[t];if(null!=r){r=Object(r);for(var i=Object.keys(Object(r)),o=0,s=i.length;o<s;o++){var a=i[o],c=Object.getOwnPropertyDescriptor(r,a);void 0!==c&&c.enumerable&&(n[a]=r[a])}}}return n}}),p.fetch||(p.fetch=function(i,o){return new Promise(function(e,n){var t=null;if(p.XMLHttpRequest?t=new XMLHttpRequest:p.ActiveXObject&&(t=new ActiveXObject("Microsoft.XMLHTTP")),null!==t){for(var r in t.open(o.method,i),t.timeout=3e4,o.headers)t.setRequestHeader(r,o.headers[r]);t.onerror=function(e){n(e)},t.ontimeout=function(e){n(e)},t.onreadystatechange=function(){if(4===t.readyState)if(202<t.status){t.status,t.responseText;n(new Error(t.responseText))}else e({body:t.responseText,json:function(){return JSON.parse(t.responseText)}})},t.send(o.body)}})});var o={},n=p.grx&&p.grx.q?p.grx.q:[],s=[];p.grx=function(){var e=arguments[0],n=i(arguments,1);if(o[e]&&"function"==typeof o[e])return o[e].apply(o,n)};var t="2.3.11";function a(e,n,t){var r=(e+"").length;if(0<n-r){for(var i=e,o=0;o<n-r;o++)i=t+""+i;return i}return e+""}var c,r="_grx",u={setDeviceCategory:function(){var e="desktop",n=navigator.userAgent;-1<n.indexOf("iPad")?e="tablet":-1<n.indexOf("Android")&&-1===n.indexOf("Mobi")?e="tablet":(-1<n.indexOf("Phone")||-1<n.indexOf("Mobi"))&&(e="mobile"),grx("set","deviceCategory",e)},showNotificationWelcomeMessage:function(e,r){grx("addListener","notification_permission_allowed",function(){var t,n=r||{title:"Thank You",content:"for subscribing to notification"};try{t=new Notification(n.title,{body:n.content,icon:n.icon,image:n.image,badge:n.badge,data:{url:n.url,flag:"grx"}})}catch(e){c&&(t=c.showNotification(n.title,{body:n.content,icon:n.icon,image:n.image,badge:n.badge,data:{url:n.url,flag:"grx"}}))}t&&(t.onclick=function(e){var n=e.target.data;t.close(),n&&n.url&&p.open(n.url)})})},trackUtm:function(e){var n=p.location.search;if(-1<n.indexOf("utm_")){if(void 0===e.projectCode)return void w("Call grx.init() with projectCode before sending trackevent");var t=["utm_source","utm_medium","utm_campaign","utm_term","utm_content"],r={},i="?"===n[0]?n.substr(1):n;((i?i.split("&"):[])||[]).map(function(e){if(e){var n=e.split("=");n[0]&&0<n[0].length&&n[1]&&0<n[1].length&&0<=t.indexOf(n[0])&&(r[decodeURIComponent(n[0])]=decodeURIComponent(n[1]||""))}}),grx("track","attribution",r)}}},l="/sw.js",f={key:"config",sdk:"growthrx",url:"https://api.growthrx.in/v2/track",attribution_tracking:!1,platform:"web",sdkVersion:t,sdkBuild:function(e){for(var n=e.split("."),t="1",r=0;r<n.length;r++)t+=a(n[r],3,0);return parseInt(t)}(t),timeInterval:1,defaultInterval:1,sessionTime:30,eventFireTimer:5,timeout:5,service_worker:l,askPermission:!0,applicationServerKey:"BJbc9ibd8jputjGDrpcWO32Ky80HfmSo7eo87NqZnE4DUlOsWLBvlE2ODc-2CkOMMgxlORpeLercmKcnP9rGccA",page_properties:{}},d=function(){var t=(new Date).getTime();return"undefined"!=typeof performance&&"function"==typeof performance.now&&(t+=performance.now()),"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var n=(t+16*Math.random())%16|0;return t=Math.floor(t/16),("x"===e?n:3&n|8).toString(16)})},g=function(e){return void 0!==e&&""!==e&&null!=e},v=function(e,n,t,r,i){var o=new Date;o.setTime(o.getTime()+24*t*60*60*1e3);var s="expires="+o.toUTCString();i||(i="/"),r||(r=location.hostname),document.cookie=e+"="+n+";"+s+";domain="+r+";path="+i+"; Secure; SameSite=Strict"},h=function(e){var n=e+"=",t=decodeURIComponent(document.cookie);if(t)for(var r=t.split(";"),i=0;i<r.length;i++){for(var o=r[i];" "===o.charAt(0);)o=o.substring(1);if(0===o.indexOf(n))return o.substring(n.length,o.length)}return""},m=function(e){var n=null;if(p.localStorage&&(n=localStorage.getItem(e))&&-1<n.indexOf("[]")){var t=n.split("[]");n=parseInt(t[1])<(new Date).getTime()?null:t[0]}return null!==n?n:h(e)},b=function(n,t,r){var e=24*(r=r||30)*60*60*1e3,i=(new Date).getTime()+e;if(p.localStorage)if(null==t)localStorage.removeItem(n);else try{localStorage.setItem(n,t+"[]"+i)}catch(e){v(n,t,r)}else v(n,t,null==t?0:r)},y="true"===m("grx_log")?Function.prototype.bind.call(p.console.log,p.console):function(){},w=function(){void 0!==p.console&&"true"===m("grx_log")&&Array.from&&y.apply(y,["GRX_LOG: "].concat(Array.from(arguments)))};w("GrowthRx SDK: v"+f.sdkVersion);var _=function(){var e=h(r);return g(e)?(x(e),b("coke_uuid",null),e):(e=m("coke_uuid"),g(e)?(x(e),b("coke_uuid",null)):(e=d(),x(e)),e)},x=function(e){var n=P();v(r,e,730,n,"/")},k=function(){var e=h("_grxs");return g(e)?(S(e),b("GRXsdkSessionId",null),e):(e=m("GRXsdkSessionId"),g(e)?(e=e.split("|")[0],S(e),b("GRXsdkSessionId",null)):(e=d(),S(e)),e)},S=function(e){var n=P(),t=1/24/60*f.sessionTime;v("_grxs",e,t,n,"/")},P=function(){var e=location.host.split(":")[0].split(".").reverse().slice(0,2).reverse().join(".");return"localhost"===e?e:"."+e};o.log=function(){w.apply(this,arguments)},o.enable_log=function(){if(p.localStorage)return localStorage.setItem("grx_log","true"),y=Function.prototype.bind.call(p.console.log,p.console),"Log Enabled"},o.disable_log=function(){if(p.localStorage)return y=function(){},localStorage.removeItem("grx_log"),"Log Disabled"},o.init=function(e,n){f=Object.assign({},f,{projectCode:e,startTimestamp:(new Date).getTime(),anonymous_id:_()},n),o.registerPlugin("setDeviceCategory"),f.service_worker!==l&&o.enablePush(Object.assign({},f,{askPermission:!1,inline:!0})),!0===f.attribution_tracking&&(p.console&&p.console.warn&&console.warn("grx('init',{attribution_tracking:true}); is deprecated, use grx('registerPlugin','trackUtm')"),o.registerPlugin("trackUtm")),setTimeout(function(){o.dispatch("ready")},1)},o.set=function(e,n){"applicationServerKey"===e?(f[e]=n,p.console&&p.console.warn&&console.warn("grx('set', 'applicationServerKey' ,'<value>') is deprecated, use grx('config','applicationServerKey', '<value>')")):"userId"===e?(f[e]=n,p.console&&p.console.warn&&console.warn("grx('set', 'userId' ,'<value>') is deprecated, use grx('userId', '<value>')")):f.page_properties[e]=n},o.config=function(e,n){"service_worker"===e&&n!==l&&o.enablePush(Object.assign({},f,{askPermission:!1,inline:!0})),f[e]=n},o.userId=function(e){f.userId=e},o.registerPlugin=function(e,n){var t=u[e];t&&"function"==typeof t&&t(f,n)};var O=function(e){try{if(s&&0<s.length){var n=s;s=[],t=f.url,i=function(e,n){e&&n&&w("Event failed:",n)},o=e,w("sending data ",r=n),fetch(t,{method:"post",headers:{Accept:"application/json","Content-Type":"application/json",sentAt:(new Date).getTime()},timeout:1e3*f.timeout,body:JSON.stringify(r),keepalive:!o}).then(function(e){return e.json()}).then(function(e){f.timeInterval=f.defaultInterval,w("Request succeeded with JSON response",e),i&&i(null,e)}).catch(function(e){w("Request failed",e),i&&i(e)})}}catch(e){F(e)}var t,r,i,o},j=-1<navigator.userAgent.indexOf("OP");p.document.addEventListener("visibilitychange",O.bind(this,j),!1);var N=function(){try{var e=(new Date).getTime()-f.startTimestamp;s.length&&(f.eventCount<=s.length||e/1e3>=f.eventFireTimer)&&(f.startTimestamp=(new Date).getTime(),O(!0)),setTimeout(N,1e3*f.timeInterval)}catch(e){F(e)}};function T(e){return f.service_worker?(w("Registering service worker: "+f.service_worker,"with permission: ",e),navigator.serviceWorker.register(f.service_worker).then(function(e){var r;return(c=e).update(),w("Service worker successfully registered."),r=f,new Promise(function(n,t){var e=new MessageChannel;e.port1.onmessage=function(e){e.data.error?t(e.data.error):(p.grx.apply(o,e.data),n(e.data))},navigator.serviceWorker.controller&&navigator.serviceWorker.controller.postMessage(r,[e.port2])}),e}).catch(function(e){w("Unable to register service worker.",e)})):(w("Not Registering service worker: value is ",f.service_worker),!1)}function C(){return m("subscribe_push")}function E(){b("subscribe_push",null,10)}function I(e){return e.pushManager.getSubscription()}function R(e,r){return new Promise(function(n,t){r.unsubscribe().then(function(){D(e).then(function(e){w("subscribed: ",e),e?n(e):t(e)}).catch(t)}).catch(t)})}function D(t){var e={userVisibleOnly:!0,applicationServerKey:function(e){for(var n="=".repeat((4-e.length%4)%4),t=(e+n).replace(/\-/g,"+").replace(/_/g,"/"),r=p.atob(t),i=new Uint8Array(r.length),o=0;o<r.length;o++)i[o]=r.charCodeAt(o);return i}(f.applicationServerKey)};return I(t).then(function(n){return n?JSON.parse(JSON.stringify(pushSubscription)):t.pushManager.subscribe(e).then(function(e){return w("Subscribed PushSubscription: "+JSON.stringify(e)),w("with applicationServerKey: "+M(e)),JSON.parse(JSON.stringify(e))}).catch(function(e){return w("Error in subscribing",e),R(t,n)})}).catch(function(e){w("Error in getSubscription",e)})}function K(i){if(i){if("granted"===Notification.permission){if(!f.applicationServerKey)return w("applicationServerKey is "+f.applicationServerKey),!1;var e=C();return new Promise(function(n,t){return e&&"{"===e[0]?(w("Already subscribed to push"),(r=i,I(r).then(function(e){return e?(w("Retrieved PushSubscription: "+JSON.stringify(e)),w("with applicationServerKey: "+M(e)),A(e,r)):(w("Could not get Subscription: "+e),null)}).catch(function(e){w("Error in get subscription",e)})).then(n).catch(t)):(E(),w("Getting current subscription"),I(i).then(function(e){return w("Got PushSubscription: "+JSON.stringify(e)),w("with applicationServerKey: "+M(e)),e?A(e,i).then(n).catch(t):D(i).then(n).catch(t)}).catch(function(e){return w("No existing subscription",e),D(i).then(n).catch(t)}));var r})}w("Cannot subscribe to push, notification permission not granted")}else w("Cannot subscribe to push, service worker not registered")}function A(r,i){return new Promise(function(e,n){var t=M(r);t&&t!==f.applicationServerKey?(w("applicationServerKey Mismatch. \nExisting: "+t,"\nNew     : "+f.applicationServerKey),w("Unsubscribing existing subscription"),R(i,r).then(e).then(n)):r&&e(JSON.parse(JSON.stringify(r)))})}function M(e){return e&&e.options&&e.options.applicationServerKey&&(n=e.options.applicationServerKey,btoa(String.fromCharCode.apply(null,new Uint8Array(n))).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_"));var n}function J(r){var e=C();if(e&&0<e.length&&!r)return w("Sending push_unsubscribed to server"),E(),e=null,new Promise(function(e,n){o.track("push_unsubscribed"),e()});if(r){var n;if(JSON.stringify(r)!==e)return w("Sending subscription to server"),n=r,b("subscribe_push",JSON.stringify(n),10),new Promise(function(e,n){var t={endpoint:r.endpoint,expirationTime:r.expirationTime,keys_p256dh:r.keys.p256dh,keys_auth:r.keys.auth};o.profile("push_subscription",t),e()});w("Already sent to server")}else w("Cannot send to server, no push subscription")}setTimeout(N,1e3*f.timeInterval),o.__track=function(e,n,t,r,i){w('track "'+n+'" to queue',e,t);try{if(void 0===f.projectCode||0===f.projectCode.length)return void w("Call grx.init() with projectCode before sending track event");t||(t={});var o=function(e,n,t,r,i){t||(t={});var o=Object.assign({},f.page_properties,t),s={projectCode:f.projectCode,gid:f.anonymous_id,name:e,type:n,properties:o,platform:f.platform,sdkVersion:f.sdkVersion,sdkBuild:f.sdkBuild,createdAt:(new Date).getTime(),sessionId:k(),insertId:d(),nonInteraction:r,userId:f.userId};i&&(s.operations=i);return s}(e,n,t,r,i);w('adding "'+n+'" to queue',e,t),s.push(o)}catch(e){F(e)}},o.track=function(e,n,t){o.__track(e,"event",n,t)},o.profile=function(e,n,t){o.__track(e,"profile",n,t)},o.operations=function(e,n,t){o.__track(e,"profile",null,t,n)},o.getGID=function(){return _()},o.getSessionID=function(){return k()},o.disablePush=function(e){E(),navigator.serviceWorker.getRegistration().then(function(e){I(e).then(function(e){e&&e.unsubscribe()})})},o.enablePush=function(e){if("serviceWorker"in navigator)if("PushManager"in p){e&&void 0!==e.service_worker&&(p.console&&p.console.warn&&!0!==e.inline&&console.warn("Declaration of service worker in grx('enablePush',{service_worker:'"+e.service_worker+"'}) is deprecated, use grx('config','service_worker','"+e.service_worker+"');grx('enablePush');"),f.service_worker=e.service_worker);var n=f.askPermission;e&&void 0!==e.askPermission&&(p.console&&p.console.warn&&!0!==e.inline&&console.warn("Declaration of askPermission in grx('enablePush',{askPermission:"+e.askPermission+"}) is deprecated, use grx('config','askPermission',"+e.askPermission+");grx('enablePush')"),n=e.askPermission,!0!==e.inline&&(f.askPermission=e.askPermission)),function(e){{if("granted"===Notification.permission)return w("Notification Permission ",Notification.permission),new Promise(function(e,n){e(Notification.permission)});if("denied"===Notification.permission)return w("Notification Permission ",Notification.permission),new Promise(function(e,n){e(Notification.permission)})}if(!e)return w("Not asking Notification Permission ",Notification.permission),new Promise(function(e,n){e(Notification.permission)});w("Notification Permission is default, asking"),C()&&E();return new Promise(function(n,e){var t=Notification.requestPermission(function(e){n(e)});t&&t.then(n,e)}).then(function(e){return"granted"===e?(w("Notification permission granted.",e),o.dispatch("notification_permission_allowed")):"denied"===e?(w("Notification permission denied.",e),o.dispatch("notification_permission_blocked")):(w("Notification permission default.",e),o.dispatch("notification_permission_closed")),e})}(n).then(T).then(K).then(J).catch(function(e){w("Error ",e)})}else w("Push isn't supported on this browser");else w("Service Worker isn't supported on this browser")},o.addListener=function(e,n){document.addEventListener(e,n,!1)},o.removeListener=function(e,n){document.removeEventListener(e,n,!1)},o.dispatch=function(e,n){var t=new CustomEvent(e,{detail:n});document.dispatchEvent?document.dispatchEvent(t):document.fireEvent&&document.fireEvent(t)},n.forEach(function(e){p.grx.apply(o,e)})}catch(e){F(e)}function F(e){if(w(e),-1<location.host.indexOf("speakingtree")&&p.ga&&e)try{ga("send","event","grx_exc",e.message,e.stack?e.stack.split("\n")[1]:"none")}catch(e){ga("send","event","grx_exc","invalid"+e.message,"could not parse")}}}(window);