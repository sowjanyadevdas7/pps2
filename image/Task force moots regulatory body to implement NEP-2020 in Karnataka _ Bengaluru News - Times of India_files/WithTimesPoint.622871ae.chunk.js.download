(window.webpackJsonp=window.webpackJsonp||[]).push([[135,169],{482:function(e,t,i){},582:function(e,t,i){"use strict";i.r(t),i.d(t,"reinitializeTPWidgets",(function(){return I}));var n,o=i(12),r=i.n(o),s=i(130),d=(i(10),i(131)),a=i.n(d),c=i(132),u=i(14),p=i(500),g=i(483),f=i(13),l=i(496),w=i(461);function m(e,t,i,o){n||(n="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var r=e&&e.defaultProps,s=arguments.length-3;if(t||0===s||(t={children:void 0}),1===s)t.children=o;else if(s>1){for(var d=new Array(s),a=0;a<s;a++)d[a]=arguments[a+3];t.children=d}if(t&&r)for(var c in r)void 0===t[c]&&(t[c]=r[c]);else t||(t=r||{});return{$$typeof:n,type:e,key:void 0===i?null:""+i,ref:null,props:t,_owner:null}}function y(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function b(e,t){return(b=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function h(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=T(e);if(t){var o=T(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return v(this,i)}}function v(e,t){return!t||"object"!==D(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function T(e){return(T=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function D(e){return(D="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function I(e){var t=new Event("reinit_tp_widget");"object"===D(e)&&e.divId&&e.widgetType&&(t.customObj=e),window.dispatchEvent(t)}var P=m("div",{}),j=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&b(e,t)}(r,e);var t,i,n,o=h(r);function r(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),(t=o.call(this,e)).getUserengagementMetrics=function(e){if("object"===("undefined"==typeof window?"undefined":D(window))&&window.tpsdk){var i=u.a.get("TicketId")||"",n={platform:t.props.isWapView?"msite":"web",channelCode:"TOI"};e&&(n.ticketId=i),window.tpsdk("init",n),window.tpsdk("fetch","nextEngagement","",t.props.getLoginTimesPointData)}},t.state={},t.sdkLoaded=!1,t.isLoggedIn=!1,t}return t=r,(i=[{key:"componentDidMount",value:function(){var e=this;window.TimesGDPR&&window.TimesGDPR.common.consentModule.gdprCallback&&window.TimesGDPR.common.consentModule.gdprCallback((function(t){t.isEUuser||(e.props.isWapView&&e.props.userData&&"boolean"==typeof e.props.userData.isLoggedIn&&e.getUserengagementMetrics(e.props.userData.isLoggedIn),!e.props.isWapView||e.props.loadTimePointSdk?e.loadSDK():e.setState({sdkLoaded:!0}),e.setConfigObj(),document.body.addEventListener("tpwidget-ready",(function(){window.loaded="tploaded",e.initialiseTimesPoint(),window.addEventListener("reinit_tp_widget",e.reinitTPWidget.bind(e))})),e.props.getAllActivities(Object(c.a)()),Object(w.b)("dailycheckin",Math.round((new Date).getTime())))}))}},{key:"componentDidUpdate",value:function(e){this.state.sdkLoaded&&((!e.userData||!e.userData.isLoggedIn)&&this.props.userData&&this.props.userData.isLoggedIn||this.props.userData.isLoggedIn&&!this.isLoggedIn)&&(Object(w.f)(),this.isLoggedIn=!0,Object(w.b)("visit",Math.round((new Date).getTime())),Object(w.b)("register",Math.round((new Date).getTime()))),this.state.sdkLoaded&&e.userData&&e.userData.isLoggedIn&&!1===this.props.userData.isLoggedIn&&(window.TPWidget&&window.TPWidget.logoutAction(),this.isLoggedIn=!1),this.state.sdkLoaded&&e.userData&&!1===e.userData.isLoggedIn&&this.props.userData&&!0===this.props.userData.isLoggedIn&&(Object(w.g)(),"undefined"!=typeof window&&window.TimesGDPR&&window.TimesGDPR.common.consentModule.gdprCallback&&window.TimesGDPR.common.consentModule.gdprCallback((function(e){e.isEUuser||Object(w.b)("dailycheckin",Math.round((new Date).getTime()))}))),this.props.isWapView&&this.props.userData&&"boolean"==typeof this.props.userData.isLoggedIn&&e.userData&&e.userData.isLoggedIn!==this.props.userData.isLoggedIn&&this.getUserengagementMetrics(this.props.userData.isLoggedIn)}},{key:"reinitTPWidget",value:function(e){this.initialiseTimesPoint(e.customObj||"")}},{key:"setConfigObj",value:function(){this.TPconfig={widgettypes:[{divId:"widget-head",widgetType:"tpwidget-one"},{divId:"widget-tp-sticky",widgetType:"tpwidget-two"},{divId:"widget-two-ATF",widgetType:"tpwidget-two"},{divId:"widget-two-BTF",widgetType:"tpwidget-two"},{divId:"widget-two",widgetType:"tpwidget-two"},{divId:"widget-two-vs",widgetType:"tpwidget-two"},{divId:"widget-banner",widgetType:"tpwidget-banner",viewportId:"TOI",carousel:!0,platform:this.props.isWapView?"msite":"web"}],widgetsArray:[],isUserLoggedIn:!1,isInitialised:!1,userInfo:[],email:Object(w.d)(),url:escape(document.location.href),pcode:"TOI",scode:"News",oid:"",uid:Object(w.e)(),aname:"",txnId:"",firsttime:!0}}},{key:"loadSDK",value:function(){this.sdkLoaded=!0;var e=this;window.tp_js=function(t,i,n){var o=t.getElementsByTagName(i)[0],r=window.tp_js||{};if(t.getElementById(n))return r;var s=t.createElement(i);return s.id=n,s.src="https://".concat((f.k,"image.timespoints.iimg.in"),"/tpwidgets/static/dist/js/main.js"),s.onload=function(){e.setState({sdkLoaded:!0})},o.parentNode.insertBefore(s,o),r._e=[],r.ready=function(e){r._e.push(e)},r}(document,"script","tp-wjs")}},{key:"initialiseTimesPoint",value:function(e){this.a="";var t=("object"===D(e)?[e]:this.TPconfig.widgettypes).map((function(e){return"widget-banner"===e.divId?{ele:e.divId,widgetType:e.widgetType,viewportId:e.viewportId,platform:e.platform,carousel:e.carousel}:{ele:e.divId,widgetType:e.widgetType,callback:function(){Object(p.tpShowModalEmitter)(e.divId)}}}));void 0!==window.TPWidget&&"function"==typeof window.TPWidget.init&&(Object(w.e)()?(this.TPconfig.email=Object(w.d)(),this.TPconfig.uid=Object(w.e)(),window.TPWidget.init({widgets:t,userLoginInfo:{host:this.TPconfig.pcode,channel:this.TPconfig.scode,URL:escape(document.location.href),userId:this.TPconfig.uid,oid:"",email:this.TPconfig.email}})):window.TPWidget.init({widgets:t}),this.props.setInititializeTPFlag())}},{key:"render",value:function(){return this.props.userPointsData&&Object(c.a)()?P:null}}])&&y(t.prototype,i),n&&y(t,n),r}(r.a.Component);j.defaultProps={userData:void 0,userPointsData:void 0,loadTimePointSdk:!1};t.default=Object(s.b)((function(e){return{userPointsData:e.timesPoint.userData,userData:a()(e,"login.userData",{})}}),(function(e){return{getLoginTimesPointData:function(t){e(Object(l.a)(t))},setInititializeTPFlag:function(){e(Object(l.c)())},getAllActivities:function(t){e(Object(g.a)(t))}}}))(j)}}]);
//# sourceMappingURL=WithTimesPoint.622871ae.chunk.js.map